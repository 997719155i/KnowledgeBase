# With AS

## 一、用法

> WITH    temp
>                   AS (select * from class),
>
>  			temp1
>                   AS (select * from temp)
>
> SELECT * FROM temp1

+ 先执行select * from class  得到一个结果，将这个结果记录为temp

+ 再将执行select *from temp 的结果存到temp1

+ 再执行select *from temp1  语句，temp1 表只是一个别名

将重复用到的大批量 的SQL语句，放到with  as 中，加一个别名，在后面用到的时候就可以直接用。

对于大批量的SQL数据，起到优化的作用。

## 二、with的相关总结（摘录别人博客）

1. 使用with子句可以让子查询重用相同的with查询块,通过select调用（with子句只能被select查询块引用），一般在with查询用到多次情况下。在引用的select语句之前定义,同级只能定义with关键字只能使用一次,多个用逗号分割。
2. with子句的返回结果存到用户的临时表空间中，只做一次查询，反复使用,提高效率。

3. 在同级select前有多个查询定义的时候，第1个用with，后面的不用with，并且用逗号隔开。

4. 最后一个with 子句与下面的查询之间不能有逗号，只通过右括号分割,with 子句的查询必须用括号括起来

5. 如果定义了with子句，而在查询中不使用，那么会报ora-32035 错误：未引用在with子句中定义的查询名。（至少一个with查询的name未被引用，解决方法是移除未被引用的with查询），注意：只要后面有引用的就可以，不一定非要在主查询中引用，比如后面的with查询也引用了，也是可以的。

6. 前面的with子句定义的查询在后面的with子句中可以使用。但是一个with子句内部不能嵌套with子句。

7. 当一个查询块名字和一个表名或其他的对象相同时，解析器从内向外搜索，优先使用子查询块名字。

8. with查询的结果列有别名，引用的时候必须使用别名或*。			